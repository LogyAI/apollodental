<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Download QR Code</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
</head>
<body>
    <h1>Download QR Code for This Page</h1>
    <div hidden id="qrcode"></div>
    <button style="background-color: darkgreen; color: white;" id="download-btn">Download QR Code</button>

    <script>
        // Generate the QR code
        var qrcode = new QRCode(document.getElementById("qrcode"), {
            text: window.location.href.replace("download_qr/",""),
            width: 1024,
            height: 1024,
            colorDark : "#000000",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });

        // Function to download the QR code
        document.getElementById("download-btn").addEventListener("click", function() {
            // Find the canvas element generated by QRCode.js
            var canvas = document.querySelector('#qrcode canvas');
            var image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");

            // Create a temporary link to initiate the download
            var tempLink = document.createElement('a');
            tempLink.download = 'QRCode.png';
            tempLink.href = image;
            // This is required for Firefox
            document.body.appendChild(tempLink);
            tempLink.click();
            document.body.removeChild(tempLink);
        });
    </script>
</body>
</html>
